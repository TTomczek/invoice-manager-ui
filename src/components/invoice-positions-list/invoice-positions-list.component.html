<div class="grid">
    <div class="col-12">

        <div class="card">
            <p-table [value]="invoicePositionFacade.getInvoicePositions()" [paginator]="true" [selection]="selectedEntity"
                     (onRowSelect)="selectEntity($event)" (onRowUnselect)="unselectEntity()"
                     selectionMode="single" [rows]="5" [rowsPerPageOptions]="[5, 10, 20]">
                <ng-template pTemplate="header">
                    <tr>
                        <th>{{ 'invoiceposition.table.header.description' | translate }}</th>
                        <th>{{ 'invoiceposition.table.header.quantity' | translate }}</th>
                        <th>{{ 'invoiceposition.table.header.unit' | translate }}</th>
                        <th>{{ 'invoiceposition.table.header.price' | translate }}</th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-position>
                    <tr [pSelectableRow]="position">
                        <td>{{ position.description }}</td>
                        <td>{{ position.quantity }}</td>
                        <td>{{ position.unit }}</td>
                        <td>{{ position.pricePerUnitInCents }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        <div class="card col-12">
            <form class="col-12">
                <div class="flex flex-column gap-2 mb-4">
                    <label for="description" class="mt-2">{{ 'invoiceposition.form.label.description' | translate }}</label>
                    <input pInputText type="text" class="form-control" id="description" [(ngModel)]="selectedEntity().description"
                           name="description"
                           required>
                    <label for="quantity" class="mt-2">{{ 'invoiceposition.form.label.quantity' | translate }}</label>
                    <input pInputText type="text" class="form-control" id="quantity"
                           [(ngModel)]="selectedEntity().quantity"
                           name="quantity" required>
                    <label for="price" class="mt-2">{{ 'invoiceposition.form.label.price' | translate }}</label>
                    <input pInputText type="number" step="100" class="form-control" id="price"
                           [(ngModel)]="selectedEntity().pricePerUnitInCents"
                           name="price" required>
                    <label for="unit" class="mt-2">{{ 'invoiceposition.form.label.unit' | translate }}</label>
                    <p-dropdown [options]="unitOptions()" [ngModel]="currentSelectedUnit()" (ngModelChange)="setUnitFromDropDown($event)" name="unit"
                                optionLabel="value" dataKey="key" id="unit"></p-dropdown>
                </div>
                @if (selectedEntity().id) {
                    <button pButton type="button" class="btn btn-primary"
                            (click)="updateInvoicePosition(selectedEntity())">{{ 'invoiceposition.form.button.update' | translate }}
                    </button>
                    <button pButton type="button" class="btn btn-danger"
                            (click)="deleteInvoicePosition(selectedEntity())">{{ 'invoiceposition.form.button.delete' | translate }}
                    </button>
                } @else {
                    <button pButton type="button" class="btn btn-primary"
                            (click)="createInvoicePosition(selectedEntity())">{{ 'invoiceposition.form.button.create' | translate }}
                    </button>
                }
            </form>
        </div>
    </div>
</div>
